<pipeline-inputs
  pipeline="pipeline"
  mode="mode"
  ng-show="mode!==modes.PIPELINE">
</pipeline-inputs>
<pipeline-canvas pipeline="pipeline" ng-show="mode===modes.CANVAS"></pipeline-canvas>
<div class="main-panels" ng-show="mode===modes.PIPELINE">
  <div
    ng-hide="expandContext < 1"
    class="left-panel">
    <pipeline-setup-navbar
      pipeline="pipeline">
    </pipeline-setup-navbar>
    <pipeline-details
      pipeline="pipeline"
      ng-show="sidebar.section == 'details'">
    </pipeline-details>
    <!-- TODO: This needs to move within the correct 'section' -->
    <jump-to-processor pipeline="pipeline" ng-show="pipeline.showJumpToProcessor"></jump-to-processor>
    <pipeline-branch-header
      pipeline="pipeline"
      ng-hide="pipeline.activeProcessorCollection === pipeline.processorCollection">
    </pipeline-branch-header>
    <div ng-show="sidebar.section == 'processors'">
<!--       <pipeline-header
        pipeline="pipeline">
      </pipeline-header> -->
      <div class="pipeline panel">
        <div
          class="pipeline-container"
          draggable-container="pipeline.activeProcessorCollection.processors"
          ng-show="pipeline.activeProcessorCollection.processors.length > 0">
          <div
            draggable-item="processor"
            ng-repeat="processor in pipeline.activeProcessorCollection.processors track by processor.processorId">
            <processor-ui-container
              pipeline="pipeline"
              processor-collection="pipeline.activeProcessorCollection"
              processor="processor">
            </processor-ui-container>
          </div>
        </div>
<!--         <div
          class="pipeline-container"
          ng-show="pipeline.activeProcessorCollection.processors.length > 0">
          <div ng-hide="pipeline.processorCollections.length > 0">
            <pipeline-on-failure pipeline="pipeline"></pipeline-on-failure>
          </div>
        </div> -->
        <div class="add-processor">
          <div
            class="form-group"
            ng-hide="pipeline.activeProcessorCollection.processors.length > 0 ||
              pipeline.processorCollections.length > 0">
            <label>
              Your pipeline is currently empty. Add a processor to get started!
            </label>
          </div>

          <div
            class="add-processor-dropdown"
            ng-hide="pipeline.activeProcessorCollection.processors.length > 0 &&
              pipeline.activeProcessorCollection.type === collectionTypes.FOREACH">
            <processor-select processor-type-id="processorTypeId"></processor-select>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="center-panel">
    <div class="buttons">
      <button
        aria-label="{{expandContext > 1 ? 'Expand Right Panel' : 'Collapse Left Panel'}}"
        tooltip="{{expandContext > 1 ? 'Expand Right Panel' : 'Collapse Left Panel'}}"
        ng-click="expandContext = expandContext - 1"
        ng-disabled="expandContext < 1"
        type="button"
        class="btn btn-primary btn-xs collapser">
        <i aria-hidden="true" class="fa fa-chevron-circle-left"></i>
      </button>
      <button
        aria-label="{{expandContext < 1 ? 'Expand Left Panel' : 'Collapse Right Panel'}}"
        tooltip="{{expandContext < 1 ? 'Expand Left Panel' : 'Collapse Right Panel'}}"
        ng-click="expandContext = expandContext + 1"
        ng-disabled="expandContext > 1"
        type="button"
        class="btn btn-primary btn-xs collapser">
        <i aria-hidden="true" class="fa fa-chevron-circle-right"></i>
      </button>
    </div>
  </div>
  <div
    ng-hide="expandContext > 1"
    class="right-panel">
    <pipeline-input pipeline="pipeline" mode="mode"></pipeline-input>
    <pipeline-output pipeline="pipeline" samples="samples"></pipeline-output>
  </div>
</div>
<!-- <button ng-click="mode=modes.CANVAS">Show Canvas</button>
<button ng-click="mode=modes.PIPELINE">Show Pipeline</button>
 -->
